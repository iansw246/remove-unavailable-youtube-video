import { isUnauthenticated } from "./requestHelpers";

// Copied from browser
const unauthenticatedError = {
  result: {
    error: {
      code: 403,
      message: "The request is missing a valid API key.",
      errors: [
        {
          message: "The request is missing a valid API key.",
          domain: "global",
          reason: "forbidden",
        },
      ],
      status: "PERMISSION_DENIED",
    },
  },
  body: '{\n  "error": {\n    "code": 403,\n    "message": "The request is missing a valid API key.",\n    "errors": [\n      {\n        "message": "The request is missing a valid API key.",\n        "domain": "global",\n        "reason": "forbidden"\n      }\n    ],\n    "status": "PERMISSION_DENIED"\n  }\n}\n',
  headers: {
    "cache-control": "private",
    "content-encoding": "gzip",
    "content-length": "181",
    "content-type": "application/json; charset=UTF-8",
    date: "Wed, 11 Jan 2023 22:49:54 GMT",
    server: "scaffolding on HTTPServer2",
    vary: "Origin, X-Origin, Referer",
  },
  status: 403,
  statusText: "Forbidden",
};

const authenticatedResponse = {
  result: {
    kind: "youtube#playlistListResponse",
    etag: "vSBurowaXLFxcOynfKf5wZ6Zvg4",
    pageInfo: {
      totalResults: 11,
      resultsPerPage: 50,
    },
    items: ["Redacted"],
  },
  body: '{\n  "kind": "youtube#playlistListResponse",\n  "etag": "vSBurowaXLFxcOynfKf5wZ6Zvg4",\n  "pageInfo": {\n    "totalResults": 11,\n    "resultsPerPage": 50\n  },\n  "items": [\n    {\n      "kind": "youtube#playlist",\n      "etag": "z-0rWewaRt_ATqhYsH5hQxmfM5c",\n      "id": "PLKjbdQIJlV5kgUwFk2V6NQQtbFeaY68KV",\n      "snippet": {\n        "publishedAt": "2023-01-11T05:29:01Z",\n        "channelId": "UCctuKDR0o4tYSE9bfAxOZFA",\n        "title": "Delete Test",\n        "description": "",\n        "thumbnails": {\n          "default": {\n            "url": "https://i.ytimg.com/vi/jbZU6QyZ8Nc/default.jpg",\n            "width": 120,\n            "height": 90\n          },\n          "medium": {\n            "url": "https://i.ytimg.com/vi/jbZU6QyZ8Nc/mqdefault.jpg",\n            "width": 320,\n            "height": 180\n          },\n          "high": {\n            "url": "https://i.ytimg.com/vi/jbZU6QyZ8Nc/hqdefault.jpg",\n            "width": 480,\n            "height": 360\n          },\n          "standard": {\n            "url": "https://i.ytimg.com/vi/jbZU6QyZ8Nc/sddefault.jpg",\n            "width": 640,\n            "height": 480\n          },\n          "maxres": {\n            "url": "https://i.ytimg.com/vi/jbZU6QyZ8Nc/maxresdefault.jpg",\n            "width": 1280,\n            "height": 720\n          }\n        },\n        "channelTitle": "Ian",\n        "localized": {\n          "title": "Delete Test",\n          "description": ""\n        }\n      },\n      "status": {\n        "privacyStatus": "private"\n      },\n      "contentDetails": {\n        "itemCount": 107\n      }\n    },\n    {\n      "kind": "youtube#playlist",\n      "etag": "Woo7JuNMaYeumAPtfvNUwMS-lBQ",\n      "id": "PLKjbdQIJlV5lo2rQjzpXLy1DaL0eLkslf",\n      "snippet": {\n        "publishedAt": "2022-12-27T04:26:56Z",\n        "channelId": "UCctuKDR0o4tYSE9bfAxOZFA",\n        "title": "Test",\n        "description": "",\n        "thumbnails": {\n          "default": {\n            "url": "https://i.ytimg.com/vi/wCdBtEM3E7Q/default.jpg",\n            "width": 120,\n            "height": 90\n          },\n          "medium": {\n            "url": "https://i.ytimg.com/vi/wCdBtEM3E7Q/mqdefault.jpg",\n            "width": 320,\n            "height": 180\n          },\n          "high": {\n            "url": "https://i.ytimg.com/vi/wCdBtEM3E7Q/hqdefault.jpg",\n            "width": 480,\n            "height": 360\n          },\n          "standard": {\n            "url": "https://i.ytimg.com/vi/wCdBtEM3E7Q/sddefault.jpg",\n            "width": 640,\n            "height": 480\n          },\n          "maxres": {\n            "url": "https://i.ytimg.com/vi/wCdBtEM3E7Q/maxresdefault.jpg",\n            "width": 1280,\n            "height": 720\n          }\n        },\n        "channelTitle": "Ian",\n        "localized": {\n          "title": "Test",\n          "description": ""\n        }\n      },\n      "status": {\n        "privacyStatus": "private"\n      },\n      "contentDetails": {\n        "itemCount": 9\n      }\n    },\n    {\n      "kind": "youtube#playlist",\n      "etag": "SBuzNN4K7XGKTaMFWcD7dW0Ari4",\n      "id": "PLKjbdQIJlV5kRcXZrod20zXQGTMvfa5aW",\n      "snippet": {\n        "publishedAt": "2021-10-09T05:49:07Z",\n        "channelId": "UCctuKDR0o4tYSE9bfAxOZFA",\n        "title": "Funny",\n        "description": "",\n        "thumbnails": {\n          "default": {\n            "url": "https://i.ytimg.com/vi/wCdBtEM3E7Q/default.jpg",\n            "width": 120,\n            "height": 90\n          },\n          "medium": {\n            "url": "https://i.ytimg.com/vi/wCdBtEM3E7Q/mqdefault.jpg",\n            "width": 320,\n            "height": 180\n          },\n          "high": {\n            "url": "https://i.ytimg.com/vi/wCdBtEM3E7Q/hqdefault.jpg",\n            "width": 480,\n            "height": 360\n          },\n          "standard": {\n            "url": "https://i.ytimg.com/vi/wCdBtEM3E7Q/sddefault.jpg",\n            "width": 640,\n            "height": 480\n          },\n          "maxres": {\n            "url": "https://i.ytimg.com/vi/wCdBtEM3E7Q/maxresdefault.jpg",\n            "width": 1280,\n            "height": 720\n          }\n        },\n        "channelTitle": "Ian",\n        "localized": {\n          "title": "Funny",\n          "description": ""\n        }\n      },\n      "status": {\n        "privacyStatus": "private"\n      },\n      "contentDetails": {\n        "itemCount": 7\n      }\n    },\n    {\n      "kind": "youtube#playlist",\n      "etag": "9-KEVhHyBC4W1_M_0Mb6Md23yxk",\n      "id": "PLKjbdQIJlV5msIOqRHt4x9R7hIde3kSSI",\n      "snippet": {\n        "publishedAt": "2021-04-24T04:14:49Z",\n        "channelId": "UCctuKDR0o4tYSE9bfAxOZFA",\n        "title": "YTP",\n        "description": "",\n        "thumbnails": {\n          "default": {\n            "url": "https://i.ytimg.com/vi/9ymihv6_ahw/default.jpg",\n            "width": 120,\n            "height": 90\n          },\n          "medium": {\n            "url": "https://i.ytimg.com/vi/9ymihv6_ahw/mqdefault.jpg",\n            "width": 320,\n            "height": 180\n          },\n          "high": {\n            "url": "https://i.ytimg.com/vi/9ymihv6_ahw/hqdefault.jpg",\n            "width": 480,\n            "height": 360\n          },\n          "standard": {\n            "url": "https://i.ytimg.com/vi/9ymihv6_ahw/sddefault.jpg",\n            "width": 640,\n            "height": 480\n          },\n          "maxres": {\n            "url": "https://i.ytimg.com/vi/9ymihv6_ahw/maxresdefault.jpg",\n            "width": 1280,\n            "height": 720\n          }\n        },\n        "channelTitle": "Ian",\n        "localized": {\n          "title": "YTP",\n          "description": ""\n        }\n      },\n      "status": {\n        "privacyStatus": "private"\n      },\n      "contentDetails": {\n        "itemCount": 4\n      }\n    },\n    {\n      "kind": "youtube#playlist",\n      "etag": "3DY1yldlrFlcZsC_Z-c3Xvbw3Dw",\n      "id": "PLKjbdQIJlV5l3bbobLXpBTdACOdS8JmFC",\n      "snippet": {\n        "publishedAt": "2020-09-06T17:47:41Z",\n        "channelId": "UCctuKDR0o4tYSE9bfAxOZFA",\n        "title": "Soundtracks",\n        "description": "",\n        "thumbnails": {\n          "default": {\n            "url": "https://i.ytimg.com/vi/p5-HxSBO4gU/default.jpg",\n            "width": 120,\n            "height": 90\n          },\n          "medium": {\n            "url": "https://i.ytimg.com/vi/p5-HxSBO4gU/mqdefault.jpg",\n            "width": 320,\n            "height": 180\n          },\n          "high": {\n            "url": "https://i.ytimg.com/vi/p5-HxSBO4gU/hqdefault.jpg",\n            "width": 480,\n            "height": 360\n          },\n          "standard": {\n            "url": "https://i.ytimg.com/vi/p5-HxSBO4gU/sddefault.jpg",\n            "width": 640,\n            "height": 480\n          },\n          "maxres": {\n            "url": "https://i.ytimg.com/vi/p5-HxSBO4gU/maxresdefault.jpg",\n            "width": 1280,\n            "height": 720\n          }\n        },\n        "channelTitle": "Ian",\n        "localized": {\n          "title": "Soundtracks",\n          "description": ""\n        }\n      },\n      "status": {\n        "privacyStatus": "unlisted"\n      },\n      "contentDetails": {\n        "itemCount": 160\n      }\n    },\n    {\n      "kind": "youtube#playlist",\n      "etag": "UJGOCAwfnWSu4TGEMaumR5vg6xQ",\n      "id": "PLKjbdQIJlV5kkHji4H0naj7S7Z-OSWVWC",\n      "snippet": {\n        "publishedAt": "2018-11-01T04:51:11Z",\n        "channelId": "UCctuKDR0o4tYSE9bfAxOZFA",\n        "title": "Songs",\n        "description": "",\n        "thumbnails": {\n          "default": {\n            "url": "https://i.ytimg.com/vi/jbZU6QyZ8Nc/default.jpg",\n            "width": 120,\n            "height": 90\n          },\n          "medium": {\n            "url": "https://i.ytimg.com/vi/jbZU6QyZ8Nc/mqdefault.jpg",\n            "width": 320,\n            "height": 180\n          },\n          "high": {\n            "url": "https://i.ytimg.com/vi/jbZU6QyZ8Nc/hqdefault.jpg",\n            "width": 480,\n            "height": 360\n          },\n          "standard": {\n            "url": "https://i.ytimg.com/vi/jbZU6QyZ8Nc/sddefault.jpg",\n            "width": 640,\n            "height": 480\n          },\n          "maxres": {\n            "url": "https://i.ytimg.com/vi/jbZU6QyZ8Nc/maxresdefault.jpg",\n            "width": 1280,\n            "height": 720\n          }\n        },\n        "channelTitle": "Ian",\n        "localized": {\n          "title": "Songs",\n          "description": ""\n        }\n      },\n      "status": {\n        "privacyStatus": "unlisted"\n      },\n      "contentDetails": {\n        "itemCount": 133\n      }\n    },\n    {\n      "kind": "youtube#playlist",\n      "etag": "VJ1WvjupUf95cbw-NnhiTR_CbPM",\n      "id": "PLKjbdQIJlV5lyt-wDuT_CUeCCOgOqzFw1",\n      "snippet": {\n        "publishedAt": "2017-08-19T20:01:50Z",\n        "channelId": "UCctuKDR0o4tYSE9bfAxOZFA",\n        "title": "IanOffline",\n        "description": "",\n        "thumbnails": {\n          "default": {\n            "url": "https://i.ytimg.com/img/no_thumbnail.jpg",\n            "width": 120,\n            "height": 90\n          },\n          "medium": {\n            "url": "https://i.ytimg.com/img/no_thumbnail.jpg",\n            "width": 320,\n            "height": 180\n          },\n          "high": {\n            "url": "https://i.ytimg.com/img/no_thumbnail.jpg",\n            "width": 480,\n            "height": 360\n          }\n        },\n        "channelTitle": "Ian",\n        "localized": {\n          "title": "IanOffline",\n          "description": ""\n        }\n      },\n      "status": {\n        "privacyStatus": "private"\n      },\n      "contentDetails": {\n        "itemCount": 91\n      }\n    },\n    {\n      "kind": "youtube#playlist",\n      "etag": "LIfjB0YGgquibJHYMkBPhuOR6RU",\n      "id": "PLKjbdQIJlV5mrVjsyrEPNrWFx5NY2-EAl",\n      "snippet": {\n        "publishedAt": "2017-08-18T21:53:43Z",\n        "channelId": "UCctuKDR0o4tYSE9bfAxOZFA",\n        "title": "Ian",\n        "description": "The tracks I like",\n        "thumbnails": {\n          "default": {\n            "url": "https://i.ytimg.com/img/no_thumbnail.jpg",\n            "width": 120,\n            "height": 90\n          },\n          "medium": {\n            "url": "https://i.ytimg.com/img/no_thumbnail.jpg",\n            "width": 320,\n            "height": 180\n          },\n          "high": {\n            "url": "https://i.ytimg.com/img/no_thumbnail.jpg",\n            "width": 480,\n            "height": 360\n          }\n        },\n        "channelTitle": "Ian",\n        "localized": {\n          "title": "Ian",\n          "description": "The tracks I like"\n        }\n      },\n      "status": {\n        "privacyStatus": "private"\n      },\n      "contentDetails": {\n        "itemCount": 209\n      }\n    },\n    {\n      "kind": "youtube#playlist",\n      "etag": "ql7dTYmNfZO5lFiyFJpRojQT2k4",\n      "id": "PLKjbdQIJlV5lOBi2wzX4-YUE6OV6yaaLi",\n      "snippet": {\n        "publishedAt": "2016-12-05T04:26:06Z",\n        "channelId": "UCctuKDR0o4tYSE9bfAxOZFA",\n        "title": "Music played in the last month",\n        "description": "",\n        "thumbnails": {\n          "default": {\n            "url": "https://i.ytimg.com/img/no_thumbnail.jpg",\n            "width": 120,\n            "height": 90\n          },\n          "medium": {\n            "url": "https://i.ytimg.com/img/no_thumbnail.jpg",\n            "width": 320,\n            "height": 180\n          },\n          "high": {\n            "url": "https://i.ytimg.com/img/no_thumbnail.jpg",\n            "width": 480,\n            "height": 360\n          }\n        },\n        "channelTitle": "Ian",\n        "localized": {\n          "title": "Music played in the last month",\n          "description": ""\n        }\n      },\n      "status": {\n        "privacyStatus": "private"\n      },\n      "contentDetails": {\n        "itemCount": 28\n      }\n    },\n    {\n      "kind": "youtube#playlist",\n      "etag": "rCp2vx8Yw1x95SllBSXxDpc-Bi8",\n      "id": "PLKjbdQIJlV5mUM10HioJtqKyRsvJ0aXii",\n      "snippet": {\n        "publishedAt": "2016-12-05T04:26:06Z",\n        "channelId": "UCctuKDR0o4tYSE9bfAxOZFA",\n        "title": "Music added in the last month",\n        "description": "",\n        "thumbnails": {\n          "default": {\n            "url": "https://i.ytimg.com/img/no_thumbnail.jpg",\n            "width": 120,\n            "height": 90\n          },\n          "medium": {\n            "url": "https://i.ytimg.com/img/no_thumbnail.jpg",\n            "width": 320,\n            "height": 180\n          },\n          "high": {\n            "url": "https://i.ytimg.com/img/no_thumbnail.jpg",\n            "width": 480,\n            "height": 360\n          }\n        },\n        "channelTitle": "Ian",\n        "localized": {\n          "title": "Music added in the last month",\n          "description": ""\n        }\n      },\n      "status": {\n        "privacyStatus": "private"\n      },\n      "contentDetails": {\n        "itemCount": 70\n      }\n    },\n    {\n      "kind": "youtube#playlist",\n      "etag": "IpnKmFF_KlFbLIZ1y4ct4tGJ0mk",\n      "id": "PLKjbdQIJlV5maqDk5LYJGAoCidchnfYTp",\n      "snippet": {\n        "publishedAt": "2016-10-25T00:50:37Z",\n        "channelId": "UCctuKDR0o4tYSE9bfAxOZFA",\n        "title": "Sleep",\n        "description": "",\n        "thumbnails": {\n          "default": {\n            "url": "https://i.ytimg.com/img/no_thumbnail.jpg",\n            "width": 120,\n            "height": 90\n          },\n          "medium": {\n            "url": "https://i.ytimg.com/img/no_thumbnail.jpg",\n            "width": 320,\n            "height": 180\n          },\n          "high": {\n            "url": "https://i.ytimg.com/img/no_thumbnail.jpg",\n            "width": 480,\n            "height": 360\n          }\n        },\n        "channelTitle": "Ian",\n        "localized": {\n          "title": "Sleep",\n          "description": ""\n        }\n      },\n      "status": {\n        "privacyStatus": "private"\n      },\n      "contentDetails": {\n        "itemCount": 78\n      }\n    }\n  ]\n}\n',
  headers: {
    "cache-control": "private",
    "content-encoding": "gzip",
    "content-length": "1525",
    "content-type": "application/json; charset=UTF-8",
    date: "Wed, 11 Jan 2023 23:04:18 GMT",
    server: "scaffolding on HTTPServer2",
    vary: "Origin, X-Origin, Referer",
  },
  status: 200,
  statusText: "OK",
};

test("unauthenticated error is unauthenticated", () => {
  expect(isUnauthenticated(unauthenticatedError)).toBe(true);
});

test("authenticated response is not unauthenticated", () => {
  expect(isUnauthenticated(authenticatedResponse)).toBe(false);
});

test("null exception is not unathenticated", () => {
  expect(isUnauthenticated(null)).toBe(false);
});

test("undefined exception is not unauthenticated", () => {
  expect(isUnauthenticated(undefined)).toBe(false);
});

test("non-object exception is not unauthenticated", () => {
  expect(isUnauthenticated("hello")).toBe(false);
  expect(isUnauthenticated(123)).toBe(false);
});

test("Error type exception is not unautnehticated", () => {
  expect(isUnauthenticated(new Error(""))).toBe(false);
  expect(isUnauthenticated(new Error("Hello"))).toBe(false);
  expect(isUnauthenticated(0)).toBe(false);
});
